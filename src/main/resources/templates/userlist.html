<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta charset="utf-8"/>
    <title>用户管理 - Admin</title>

    <meta name="description" content="along with an email converter tool"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}"/>
    <!-- bootstrap-table 表格插件样式 -->
    <link th:href="@{/js/plugins/bootstrap-table/bootstrap-table.min.css}" rel="stylesheet"/>
   
    <style>
        html, body {
            margin: 0px;
            height: 100%;
        }
    </style>
</head>

<body>
<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">查询条件</h3>
    </div>
    <div class="panel-body">
        <form class="form-inline" role="form" id="queryForm">
            <div class="form-group">
                <label for="txtTitle">名称:</label>
                <input type="text" class="form-control" name="txtTitle" id="txtTitle"
                       placeholder="请输入名称">
            </div>
            <div class="form-group">
                <label for="selMenuType">类型:</label>
                <select class="form-control" id="selMenuType">
                    <option value="M">管理员</option>
                    <option value="C">员工</option>
                    <option value="F">经理</option>
                </select>
            </div>
            <div class="form-group">
                <label class="control-label">状态：</label>
                <select class="form-control" id="selVisible">
                    <option value="0">禁用</option>
                    <option value="1">启用</option>
                </select>
            </div>
            <div class="form-group">
                <input class="btn btn-primary" type="button" value="查询" onclick="SearchData()">
            </div>
        </form>
    </div>
    <div id="toolbar" class="btn-group" style="padding-bottom:15px">
        <div class="col-sm-12 text-left">
            <button id="btn_add" type="button" class="btn btn-success">
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>新增
            </button>
            <button id="btn_edit" type="button" class="btn btn-warning">
                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>修改
            </button>
            <button id="btn_delete" type="button" class="btn btn-danger">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>删除
            </button>
            <button id="btn_authorize" type="button" class="btn btn-info ">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>批量删除
            </button>
        </div>
    </div>
    <table id="table"></table>
    <div id="context-menu" data-toggle="context" data-target="#context-menu">
        <ul class="dropdown-menu" role="menu">
            <li><a href="#">关闭其他标签</a></li>
            <li><a href="#">关闭全部标签</a></li>
        </ul>
    </div>
</div>

<script th:src="@{/js/jquery.min.js}"></script>
<script th:src="@{/js/bootstrap.min.js}"></script>
<!-- bootstrap-table 表格插件 -->
<script th:src="@{/js/plugins/bootstrap-table/bootstrap-table.js}"></script>
<script th:src="@{/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.js}"></script>
<script th:src="@{/js/plugins/bootstrap-table/extensions/mobile/bootstrap-table-mobile.js}"></script>
<script th:src="@{/js/plugins/bootstrap-table/extensions/toolbar/bootstrap-table-toolbar.js}"></script>
<script th:src="@{/js/plugins/bootstrap-table/extensions/export/bootstrap-table-export.js}"></script>
<script th:src="@{/js/plugins/bootstrap-table/extensions/export/tableExport.js}"></script>
<script th:src="@{/js/bootstrap-contextmenu.js}"></script>

<script inline="javascript">
    var $table;
    $(function () {
        //1.初始化Table
        InitMainTable();
        $table.contextmenu({
            target: '#context-menu',
            onItem: function (context, e) {
                alert($(e.target).text());
            }
        });
    });

    //初始化bootstrap-table的内容
    function InitMainTable() {
        //记录页面bootstrap-table全局变量$table，方便应用
        var queryUrl = '/user/getUserList?rnd=' + Math.random()
        $table = $('#table').bootstrapTable({
            method: 'get',
            url: queryUrl,
            queryParams: getQueryParams,
            striped: true,                      //是否显示行间隔色
            toolbar: '#toolbar',                //工具按钮用哪个容器
            //showRefresh: true,                  //是否显示刷新按钮
            pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
            pagination: true,                   //是否显示分页（*）
            clickToSelect: true,
            cache: false,
            //showExport: true,                     //是否显示导出
            //exportDataType: "basic",              //basic', 'all', 'selected'.
            exportOptions: {
                ignoreColumn: [1],  //忽略某一列的索引
                fileName: '总报表',  //文件名称设置
                worksheetName: 'sheet1',  //表格工作区名称
                tableName: '总报表'
            },
            columns: [
                {checkbox: true},
                {field: "userId", title: "ID", align: "center", visible: false},
                {field: "userName", title: "登录名称", align: "center"},
                {field: "loginName", title: "用户名称", align: "center"},
                {field: "operate", title: "操作", align: "center", formatter: operateFormatter, edit: false}
            ]
        });
    };

    //查询条件
    function getQueryParams(params) {
        return {
            pageSize: params.pageSize,
            pageIndex: params.pageNumber,
            loginName: $.trim($("#txtTitle").val()),
            //menuType: $("#selMenuType").val(),
            //visible: $("#selVisible").val(),
        };
    }
    //查询事件
    function SearchData() {
        $('#table').bootstrapTable('refresh', {pageNumber: 1});
    }
    
    function test() {
        var selRows = $table.bootstrapTable("getSelections");
        if (selRows.length == 0) {
            alert("请至少选择一行");
            return;
        }

        var postData = "";
        $.each(selRows, function (i) {
            postData += this.userId;
            if (i < selRows.length - 1) {
                postData += "， ";
            }
        });
        alert("你选中行的 id 为：" + postData);
    }


    function operateFormatter(value, row, index) {
        return [
            "<a class=\"remove\" href='javascript:removeRow(" + row.userId + ")' title=\"删除改行\">",
            "<i class='glyphicon glyphicon-remove'></i>",
            "</a>     "
        ].join('');
    }

    //删除指定行
    function removeRow(deleteIndex) {
        alert(deleteIndex);
    }
</script>
</body>
</html>
